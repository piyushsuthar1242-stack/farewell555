<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>

<style>
body{
margin:0;
font-family:Arial;
background:#f1f3f6;
}

.sidebar{
position:fixed;
left:0;
top:0;
width:220px;
height:100%;
background:#1e2a38;
color:white;
padding:20px;
}

.sidebar h2{margin-bottom:20px;}

.main{
margin-left:240px;
padding:20px;
}

.cards{
display:flex;
flex-wrap:wrap;
gap:15px;
margin-bottom:20px;
}

.card{
flex:1 1 150px;
padding:20px;
border-radius:8px;
color:white;
cursor:pointer;
font-size:16px;
text-align:center;
}

.card:nth-child(1){background:#3498db;}
.card:nth-child(2){background:#9b59b6;}
.card:nth-child(3){background:#e67e22;}
.card:nth-child(4){background:#27ae60;}
.card:nth-child(5){background:#e74c3c;}
.card:nth-child(6){background:#16a085;}
.card:nth-child(7){background:#2c3e50;}
.card:nth-child(8){background:#8e44ad;}
.card:nth-child(9){background:#d35400;}

table{
width:100%;
border-collapse:collapse;
background:white;
}

th,td{
padding:10px;
border-bottom:1px solid #ddd;
}

.delete{
background:red;
color:white;
border:none;
padding:6px 10px;
border-radius:5px;
cursor:pointer;
}

.download{
background:#3498db;
color:white;
padding:8px 15px;
border:none;
border-radius:5px;
margin-bottom:15px;
cursor:pointer;
}

@media(max-width:768px){
.sidebar{width:100%;height:auto;position:relative;}
.main{margin-left:0;}
.cards{flex-direction:column;}
}
</style>
</head>

<body>

<div class="sidebar">
<h2>Admin Panel</h2>
<p>Student Dashboard</p>
</div>

<div class="main">

<h2>Total Students: <span id="total">0</span></h2>

<div class="cards">
<div class="card" onclick="filterClass('FYBCA')">FYBCA</div>
<div class="card" onclick="filterClass('SYBCA')">SYBCA</div>
<div class="card" onclick="filterClass('TYBOM')">TYBOM</div>
<div class="card" onclick="filterClass('FYBBA')">FYBBA</div>
<div class="card" onclick="filterClass('SYBBA')">SYBBA</div>
<div class="card" onclick="filterClass('TYBAA')">TYBAA</div>
<div class="card" onclick="filterClass('FYBCOM')">FYBCOM</div>
<div class="card" onclick="filterClass('SYBOM')">SYBOM</div>
<div class="card" onclick="filterClass('TYBCOM')">TYBCOM</div>
</div>

<button class="download" onclick="downloadExcel()">Download Excel</button>

<table>
<thead>
<tr>
<th>Name</th>
<th>Roll</th>
<th>Class</th>
<th>Email</th>
<th>Phone</th>
<th>Delete</th>
</tr>
</thead>
<tbody id="data"></tbody>
</table>

</div>

<script>
const firebaseConfig = {
apiKey: "AIzaSyBIdKRuJo_oSR-PV4K4svr9YojA7g-Vgj4",
authDomain: "party-4f9f7.firebaseapp.com",
projectId: "party-4f9f7",
storageBucket: "party-4f9f7.firebasestorage.app",
messagingSenderId: "615273128511",
appId: "1:615273128511:web:d99127fa938f13658c4e8a"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let allData=[];

function loadData(){
db.collection("students").onSnapshot(snapshot=>{
allData=[];
snapshot.forEach(doc=>{
allData.push({id:doc.id,...doc.data()});
});
showData(allData);
});
}

function showData(data){
let html="";
document.getElementById("total").innerText=data.length;

data.forEach(d=>{
html+=`
<tr>
<td>${d.name}</td>
<td>${d.roll}</td>
<td>${d.class}</td>
<td>${d.email}</td>
<td>${d.phone}</td>
<td><button class="delete" onclick="deleteData('${d.id}')">Delete</button></td>
</tr>`;
});

document.getElementById("data").innerHTML=html;
}

function filterClass(cls){
let filtered=allData.filter(d=>d.class==cls);
showData(filtered);
}

function deleteData(id){
db.collection("students").doc(id).delete();
}

function downloadExcel(){
let csv="Name,Roll,Class,Email,Phone\n";
allData.forEach(d=>{
csv+=`${d.name},${d.roll},${d.class},${d.email},${d.phone}\n`;
});

let blob=new Blob([csv]);
let a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="students.csv";
a.click();
}

loadData();
</script>

</body>
</html>
